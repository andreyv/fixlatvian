%%
%% This is file `fixlatvian.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% fixlatvian.dtx  (with options: `package')
%% 
%% Copyright (C) Andrey Vihrov <andrey.vihrov@gmail.com>, 2010
%% Copyright (C) Madars Virza <madars@gmail.com>, 2010
%% 
%% This file may be distributed and/or modified under the conditions of
%% the LaTeX Project Public License, either version 1.2 of this license
%% or (at your option) any later version.  The latest version of this
%% license is in:
%% 
%%    http://www.latex-project.org/lppl.txt
%% 
%% and version 1.2 or later is part of all distributions of LaTeX version
%% 1999/12/01 or later.
%% 
\NeedsTeXFormat{LaTeX2e}[2009/09/24]
\ProvidesPackage{fixlatvian}
  [2010/07/04 v0 Improved Latvian support]
\RequirePackage{polyglossia}
\@ifundefined{latvian@loaded}{\setdefaultlanguage{latvian}}{}
\RequirePackage{xstring}
\RequirePackage{etoolbox}
\RequirePackage{perpage}
\RequirePackage{indentfirst}
\DeclareOption{frenchspacing}{\frenchspacing}
\DeclareOption{nonfrenchspacing}{\nonfrenchspacing}
\ExecuteOptions{frenchspacing}
\ProcessOptions\relax
\newcommand{\FixL@warning}[1]{%
  \PackageWarning{fixlatvian}{#1}}
\newcommand{\FixL@warning@noline}[1]{%
  \PackageWarningNoLine{fixlatvian}{#1}}
\newcommand{\FixL@info}[1]{\PackageInfo{fixlatvian}{#1}}
\newif\ifFixL@hyperref@before
\@ifpackageloaded{hyperref}{\FixL@hyperref@beforetrue}{}
\AtBeginDocument{%
  \@ifpackageloaded{hyperref}{%
    \ifFixL@hyperref@before%
    \else%
      \FixL@warning@noline{%
        This package should be loaded after \space hyperref%
      }%
    \fi%
  }{}}
\newcommand{\FixL@alnum}{%
  ABCDEFGHIJKLMNOPQRSTUVWXYZ%
  abcdefghijklmnopqrstuvwxyz%
  0123456789%
}
\newcommand{\FixL@patchfailed}[1]{%
  \FixL@info{Could not change the definition of the \protect #1 command}}
\CheckCommand*{\@seccntformat}[1]{\csname the#1\endcsname\quad}
\renewcommand{\@seccntformat}[1]{%
  \csname the#1\endcsname.\hspace{.66667em}}
\let\FixL@save@numberline\numberline
\renewcommand{\numberline}[1]{%
  \StrRight{#1}{1}[\FixL@temp@a]%
  \FixL@save@numberline{#1%
    \IfSubStr{\FixL@alnum}{\FixL@temp@a}{.}{}%
  }}
\AtBeginDocument{%
  \let\nref\ref%
  \let\npageref\pageref%
}
\newcommand{\FixL@ref@base}[4]{%
  \begingroup%
    \newcommand{\FixL@temp@b}{\csname n#1\endcsname#2{#4}.\@}%
    \IfStrEq{#3}{hyper}{\hyperref[#4]{\FixL@temp@b}}{\FixL@temp@b}%
  \endgroup%
  \nobreak%
}
\AtBeginDocument{%
  \@ifpackageloaded{hyperref}{%
    \newcommand{\FixL@ref}[1]{\FixL@ref@base{ref}{*}{hyper}{#1}}%
    \newcommand{\FixL@ref@star}[1]{\FixL@ref@base{ref}{*}{}{#1}}%
    \renewcommand{\ref}{\@ifstar\FixL@ref@star\FixL@ref}%
    \newcommand{\FixL@pageref}[1]{\FixL@ref@base{pageref}{*}{hyper}{#1}}%
    \newcommand{\FixL@pageref@star}[1]{\FixL@ref@base{pageref}{*}{}{#1}}%
    \renewcommand{\pageref}{\@ifstar\FixL@pageref@star\FixL@pageref}%
  }{%
    \renewcommand{\ref}[1]{\FixL@ref@base{ref}{}{}{#1}}%
    \renewcommand{\pageref}[1]{\FixL@ref@base{pageref}{}{}{#1}}%
  }%
  \robustify{\ref}%
  \robustify{\pageref}%
}
\@ifundefined{@makechapterhead}{}{%
  \patchcmd{\@makechapterhead}{%
    \@chapapp\space \thechapter%
  }{%
    \IfStrEq{\@chapapp}{\appendixname}{%
      \@chapapp\space\thechapter%
    }{%
      \thechapter.\nobreakspace\@chapapp%
    }%
  }{}{%
    \FixL@patchfailed{\chapter}%
  }}
\newcommand{\FixL@fix@part}[1]{%
  \@ifundefined{#1}{}{%
    \renewcommand{\thepart}{\arabic{part}}%
    \expandafter\patchcmd\csname#1\endcsname{%
      \partname\nobreakspace\thepart%
    }{%
      \thepart.\nobreakspace\partname%
    }{}{%
      \FixL@patchfailed{\part}%
    }%
  }}
\AtBeginDocument{%
  \@ifpackageloaded{hyperref}{%
    \FixL@fix@part{H@old@part}%
  }{%
    \FixL@fix@part{@part}%
  }}
\newcommand{\FixL@inpackage}[2]{%
  \AtBeginDocument{\@ifpackageloaded{#1}{#2}{}}}
\newcommand{\FixL@translate}[3]{%
  \FixL@inpackage{#1}{%
    \expandafter\renewcommand\csname#2\endcsname{#3}%
  }}
\gappto\captionslatvian{%
  \renewcommand{\chaptername}{nodaļa}%
  \renewcommand{\indexname}{Rādītājs}%
  \renewcommand{\partname}{daļa}%
  \renewcommand{\alsoname}{sk.~arī}%
}
\renewcommand{\@alph}[1]{%
  \ifcase #1\or a\or b\or c\or d\or e\or f\or g\or h\or i\or j\or k\or l%
  \or m\or n\or o\or p\or r\or s\or t\or u\or v\or z\else\@ctrerr\fi}
\renewcommand{\@Alph}[1]{%
  \ifcase #1\or A\or B\or C\or D\or E\or F\or G\or H\or I\or J\or K\or L%
  \or M\or N\or O\or P\or R\or S\or T\or U\or V\or Z\else\@ctrerr\fi}
\FixL@translate{algorithm}{listalgorithmname}{Algoritmu saraksts}
\FixL@inpackage{algorithm}{\floatname{algorithm}{Algoritms}}
\FixL@translate{appendix}{appendixtocname}{Pielikumi}
\newcommand{\FixL@doc@glossaryname}{Izmaiņu saraksts}
\FixL@inpackage{doc}{\GlossaryPrologue{%
  \section*{\FixL@doc@glossaryname}%
  \markboth{\FixL@doc@glossaryname}{\FixL@doc@glossaryname}%
}}
\FixL@inpackage{doc}{\IndexPrologue{%
  \section*{\indexname}%
  \markboth{\indexname}{\indexname}%
  Numuri kursīvā apzīmē lappusi, kurā aprakstīta attiecīgā komanda;
  pasvītrotie numuri norāda uz komandas \ifcodeline@index definīcijas
  pirmkoda rindu\else definīciju\fi; numuri parastajā rakstā apzīmē
  \ifcodeline@index pirmkoda rindu\else lappusi\fi, kurā komanda tiek
  izmantota.%
}}
\FixL@translate{doc}{generalname}{Vispārīgs ieraksts}
\FixL@translate{listings}{lstlistlistingname}{Pirmkoda tekstu saraksts}
\FixL@translate{listings}{lstlistingname}{Pirmkoda teksts}
\MakePerPage{footnote}
\patchcmd{\@makecaption}{#1: #2}{#1.\nobreakspace #2}{}{%
  \FixL@patchfailed{\caption}}
\renewcommand{\fnum@figure}{\figurename\,\thefigure}
\endinput
%%
%% End of file `fixlatvian.sty'.
